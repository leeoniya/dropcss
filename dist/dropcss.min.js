/*! https://github.com/leeoniya/dropcss (v1.0.5) */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).dropcss=t()}(this,function(){"use strict";var e=1,t=2,n=3,r=new Set("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),a=/<!doctype[^>]*>|<!--[\s\S]*?-->|<script[^>]*>[\s\S]*?<\/script>|<style[^>]*>[\s\S]*?<\/style>|<link[^>]*>|<meta[^>]*>/gim,s=/([\w-]+)(?:="([^"]*)"|='([^']*)'|=(\S+))?/gm,i={TAG_HEAD:/\s*<([a-z0-9_-]+)(?:\s*([^>]*))?>\s*/imy,TEXT:/\s*[^<]*/my,TAG_CLOSE:/\s*<\/[a-z0-9_-]+>\s*/imy};var c=new Set;function o(e,t,n){return{tagName:t,attributes:n,classList:null!=n&&n.has("class")?new Set(n.get("class").split(/\s+/g)):c,parentNode:e,childNodes:[]}}function u(e,t){if(null!=e){var n=e._ofTypes=e._ofTypes||{};if(!(t in n)){var r=0;n[t]=e.childNodes.filter(function(e){if(e.tagName==t)return e._typeIdx=r++,!0})}return n[t]}return[]}var l=function(u){var l=function(a){var c,o=0,u=[];function l(e){for(var t in o=e.lastIndex,i)i[t].lastIndex=o}function d(){if(null!=(c=i.TAG_CLOSE.exec(a)))return l(i.TAG_CLOSE),void u.push(n);if(null==(c=i.TAG_HEAD.exec(a)))null!=(c=i.TEXT.exec(a))&&l(i.TEXT);else{l(i.TAG_HEAD);var o=c[1];u.push(e,o);var d=c[2];if(null!=d){for(var f,h=new Map;f=s.exec(d);)h.set(f[1],(f[2]||f[3]||f[4]||"").trim());u.push(t,h)}r.has(o)&&u.push(n)}}for(;o<a.length;)d();return l({lastIndex:0}),u}(u=u.replace(a,"")),d={nodes:[],tag:new Set(["*"]),class:new Set,attr:new Set};!function(r,a){for(var s,i=o(null,"root",c),u=0;u<r.length;u++)switch(r[u]){case e:var l=r[++u],d=c;r[u+1]===t&&(d=r[u+=2]),s=i.childNodes.length,i.childNodes.push(i=o(i,l,d)),a(i,s);break;case n:i=i.parentNode}}(l,function(e,t){return function(e,t,n){e.idx=t;var r=e.attributes;n.tag.add(e.tagName),e.classList.forEach(function(e){return n.class.add(e)}),r.has("id")&&n.attr.add("[id="+r.get("id")+"]"),r.has("type")&&n.attr.add("[type="+r.get("type")+"]"),n.nodes.push(e)}(e,t,d)});return d},d=/\s*\/\*[\s\S]*?\*\/\s*/gm,f=/\s*[>~+.#]\s*|\[[^\]]+\]|\s+/gm,h=1,p=2,v=3,x=4,m=5;function g(e){var t=e.split(/\s*,\s*/gm);return t.push(t.map(function(e){return function(e){for(var t=e.length;(e=e.replace(y,"")).length!=t;)t=e.length;return e.replace(/:?:[a-z-]+/gm,"")}(e).trim().replace(f,function(e,t){return e=e.trim(),0==t?e:"."==e||"#"==e?"`"+e:e.length<=1?"`":"`"+e.replace(/['"]/gm,"")}).split(/`+/gm)})),t}var y=/:[a-z-]+\([^()]*\)/;function b(e,t,n,r){for(var a="",s=1;e[t]==n?s++:e[t]==r&&s--,0!=s;)a+=e[t++];return a}function k(e){return function(e){var t,n={RULE_HEAD:/\s*([^{;]+?)\s*[{;]\s*/my,RULE_TAIL:/\s*([^}]*?)\s*\}/my,AT_TAIL:/\s*\}/my,RULE_FULL:/\s*([^{]*?)\{([^}]+?)\}/my},r=0,a=0,s=[];function i(e){for(var t in a=e.lastIndex,n)n[t].lastIndex=a}function c(){if(r>0&&null!=(t=n.AT_TAIL.exec(e)))return r--,s.push(p),void i(n.AT_TAIL);if(null!=(t=n.RULE_HEAD.exec(e))){var c=t[1];if(i(n.RULE_HEAD),"@"==c[0])switch(c.match(/@[a-z-]+/)[0]){case"@media":case"@supports":case"@document":r++,s.push(h,c);break;case"@import":case"@charset":case"@namespace":s.push(m,c+";");break;default:r++;var o=b(e,a,"{","}");i({lastIndex:a+o.length}),s.push(h,c,m,o)}else s.push(v,g(t[1])),t=n.RULE_TAIL.exec(e),s.push(x,t[1]),i(n.RULE_TAIL)}else a=e.length}for(;a<e.length;)c();return s}(e=e.replace(d,""))}function E(e){return e.replace(/@[a-z-]+[^{]+\{\s*\}/gm,"")}var T=/^([+-]?\d*)?n([+-]\d+)?$/;function I(e,t){return t==e.tagName||"*"==t}function _(e,t,n,r){r=r||"=";var a=e.attributes;if(a.has(t)){var s=a.get(t);switch(r){case"=":return null==n||n==s;case"*=":return-1!=s.indexOf(n);case"^=":return s.startsWith(n);case"$=":return s.endsWith(n);case"~=":return n==s||s.startsWith(n+" ")||s.endsWith(" "+n)||-1!=s.indexOf(" "+n+" ")}}return!1}function A(e,t){return e.classList.has(t)}function w(e,t){var n;if("odd"==t)n=e%2==1;else if("even"==t)n=e%2==0;else if(/^\d+$/.test(t))n=e==+t;else{var r=function(e){var t=T.exec(e);if(null!=t){var n=t[1],r=t[2];return[n=null==n||"+"==n?1:"-"==n?-1:+n,r=null==r?0:+r]}return[0,0]}(t);n=function(e,t,n){if(t<0&&e<=0)return!1;if(-1===e)return n<=t;if(0===e)return n===t;if(1===e)return t<0||n>=t;var r=t%e;return r<0&&(r+=e),e>1?n>=t&&n%e===r:(e*=-1,n<=t&&n%e===r)}(r[0],r[1],e)}return n}function N(e,t){return e.some(function(e){return function e(t,n){for(var r,a,s,i,c,o;n.idx>-1;){switch(t[n.idx]){case"_":r=t[--n.idx],o=I(n.node,r),n.idx--;break;case"#":a=t[--n.idx],o=_(n.node,"id",a,"="),n.idx--;break;case".":r=t[--n.idx],o=A(n.node,r),n.idx--;break;case"[":r=t[--n.idx],s=t[--n.idx],a=t[--n.idx],o=_(n.node,r,a,s),n.idx--;break;case":":r=t[--n.idx],a=t[--n.idx];var l=n.node,d=l.tagName;c=l.idx;var f=(i=l.parentNode)?i.childNodes.length:1,h=void 0;switch(r){case"not":o=!e(a,{node:n.node,idx:a.length-1});break;case"first-child":o=0==c;break;case"last-child":o=c==f-1;break;case"only-child":o=1==f;break;case"nth-child":o=w(c+1,a);break;case"nth-last-child":o=w(f-c,a);break;case"first-of-type":h=u(i,d),o=0==l._typeIdx;break;case"last-of-type":h=u(i,d),o=l._typeIdx==h.length-1;break;case"only-of-type":o=1==(h=u(i,d)).length;break;case"nth-of-type":h=u(i,d),o=w(l._typeIdx+1,a);break;case"nth-last-of-type":o=w((h=u(i,d)).length-l._typeIdx,a)}n.idx--;break;case" ":for(c=--n.idx,o=!1;!o&&null!=(i=n.node.parentNode);)n.idx=c,n.node=i,o=e(t,n);break;case">":n.idx--,null!=(i=n.node.parentNode)?(n.node=i,o=e(t,n)):o=!1;break;case"+":n.idx--,null!=(i=n.node.parentNode)&&n.node.idx>0?(n.node=i.childNodes[n.node.idx-1],o=e(t,n)):o=!1;break;case"~":if(n.idx--,o=!1,c=n.node.idx,null!=(i=n.node.parentNode)&&c>0)for(var p=0;p<c&&!o;p++)n.node=i.childNodes[p],o=e(t,n)}if(!o)break}return o}(t,{idx:t.length-1,node:e})})}var S=function(e,t){return N(e,Array.isArray(t)?t:function e(t){var n,r={IDENT:/([\w*-]+)/iy,ATTR:/([\w-]+)(?:(.?=)"?([^\]]*?)"?)?\]/iy,PSEUDO:/([\w-]+)(\()?/iy,MODE:/\s*[:.#\[]\s*/iy,COMB:/\s*[>~+]\s*|\s+/iy},a=0,s=[],i=-1;function c(e){for(var t in a=e.lastIndex,r)r[t].lastIndex=a}function o(){var o=!1;if(n=r.COMB.exec(t)){o=!0;var u=n[0].trim();""==u&&(u=" "),s.push(u),c(r.COMB),i=a}else if(n=r.MODE.exec(t)){o=!0;var l=n[0].trim();if(c(r.MODE),":"==l){if("("==(n=r.PSEUDO.exec(t))[2]){var d=b(t,r.PSEUDO.lastIndex,"(",")");r.PSEUDO.lastIndex+=d.length+1,n[2]="not"==n[1]?e(d):d}s.splice(i+1,0,n[2],n[1],l),c(r.PSEUDO)}else"["==l?(n=r.ATTR.exec(t),s.splice(i+1,0,n[3],n[2],n[1],l),c(r.ATTR)):(n=r.IDENT.exec(t),s.push(n[1],l),c(r.IDENT))}else(n=r.IDENT.exec(t))&&(o=!0,s.push(n[1],"_"),c(r.IDENT));return o}for(;a<t.length;)o();return s}(t))},L=/\[([\w-]+)(?:(.?=)"?([^\]]*?)"?)?\]/i,D=/:(?:first|last|nth|only|not)\b/;function O(e,t,n,r,a){a=a||"";for(var s=t.length-1;s>-1;s--){var i=t[s];n.has(i[2])||!0!==r(a+i[2])||(c=e,o=i[0],u=i[1],l="",e=c.slice(0,o)+l+c.slice(o+u))}var c,o,u,l;return e}var U=function(e){return!0};return function(e){for(var t=l(e.html,!e.keepText),n=e.shouldDrop||U,r=k(e.css),a={},s=0;s<r.length;s++)if(r[s]===v){var i=r[s+1],c=i[i.length-1];s++;for(var o=0;o<c.length;o++){var u=c[o];e:for(var d=0;d<u.length;d++){var f=u[d],g=!1,y=void 0;if(""!=f){if(f in a)g=a[f];else switch(f[0]){case"#":y=f.substr(1),a[f]=g=t.attr.has("[id="+y+"]");break;case".":y=f.substr(1),a[f]=g=t.class.has(y);break;case"[":if(f.startsWith("[type="))a[f]=g=t.attr.has(f);else{var T=f.match(L);a[f]=g=t.nodes.some(function(e){return _(e,T[1],T[3],T[2])})}break;default:a[f]=g=t.tag.has(f)}if(!g){!0===n(i[o])?i[o]=null:a[i[o]]=!0;break e}}}}}for(var I=0;I<r.length;I++)r[I]===v&&(r[++I].length,r[I]=r[I].filter(function(e){if("string"==typeof e){if(e in a)return a[e];var r=(s=e).replace(/:?:[a-z-]+/gm,function(e){return s.startsWith("::")||!D.test(e)?"":e}).replace(/:[a-z-]+\(\)/gm,"");return""==r||(r in a?a[r]:a[r]=S(t.nodes,r)||!0!==n(e))}var s;return!1}));var A=function(e){for(var t="",n=0,r=0;r<e.length;r++)switch(e[r]){case v:var a=e[++r];(n=a.length)>0&&(t+=a.join());break;case x:n>0&&(t+="{"+e[++r]+"}");break;case h:t+=e[++r]+"{";break;case p:t+="}";break;case m:t+=e[++r]}return E(t)}(r);return{css:E(A=function(e,t){for(var n,r=[],a=new Set,s=/@font-face[\s\S]+?font-family:\s*(['"\w-]+)[^}]+\}/gm;n=s.exec(e);){var i=n[1].replace(/['"]/gm,"");r.push([n.index,n[0].length,i])}for(var c=/font-family:([^;!}]+)/gm;n=c.exec(e);)r.some(function(e){return n.index>e[0]&&n.index<e[0]+e[1]})||n[1].trim().split(",").forEach(function(e){a.add(e.trim().replace(/['"]/gm,""))});return O(e,r,a,t,"@font-face ")}(A=function(e,t){for(var n,r=[],a=new Set,s=/@(?:-\w+-)?keyframes\s+([\w-]+)\s*\{/gm;n=s.exec(e);){var i=b(e,s.lastIndex,"{","}");r.push([n.index,n[0].length+i.length+1,n[1]])}for(var c=/animation(?:-name)?:([^;!}]+)/gm;n=c.exec(e);)n[1].trim().split(",").forEach(function(e){var t=(e=e.trim()).match(/^\S+/)[0];/^-?[\d.]+m?s/.test(t)&&(t=e.match(/\S+$/)[0]),a.add(t)});return O(e,r,a,t,"@keyframes ")}(A,n),n)),tokens:r}}});
